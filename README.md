# Report-Automation
Report Automation between Word and Excel, generated by VBA programming.
# Excel to Word through Bookmarks
    Sub copy()
    On Error Resume Next
    Dim sht As Worksheet
    Dim vexcel As Excel.Application
    Dim vwb As Workbook
    Dim vdoc As Document
    
    Set vdoc = ThisDocument
    Set vexcel = New Excel.Application
    Set vwb = vexcel.Workbooks.Open(ThisDocument.Path & "\xxxx.xlsx") 'xxxx is workbook's name
    vexcel.Visible = True
    Set sht = vwb.Worksheets("xxxx") 'xxxx is worksheet's name
    With vdoc.Bookmarks
    .Item("xx").Range.Text = sht.Range("xxx").Value
    .Item("xx").Range.Text = sht.Range("xxx").Value & "." & sht.Range("xxx").Value
    .Item("xx").Range.Text = sht.Range("xxx").Value & " " & sht.Range("xxx").Value & " " & sht.Range("xxx").Value & " " & sht.Range("xxx").Value & sht.Range("xxx").Value & sht.Range("xxx").Value    'xx is bookmark's name and xxx is cells' topleft address 
    
    End With
    MsgBox "Done"
    End Sub
    Private Sub CommandButton1_Click()
    copy
    End Sub
# Excel to Word through Tables   

    Set vdoc = ThisDocument
    Set vexcel = New Excel.Application
    Set vwb = vexcel.Workbooks.Open(ThisDocument.Path & "\xxxx.xlsx")  ' xxxx is workbook's name
    vexcel.Visible = True
    Set sht = vwb.Worksheets("xxxx") ' xxxx is worksheet's name
    vdoc.Tables(6).Cell(2, 2).Range = sht.Range("c8") & "." & sht.Range("c9")  'to distinguish word and excel cell, it should be 'cell' here to discribe the cell in word, if excel, it should be 'cells'
    vdoc.Tables(17).Cell(2, 2).Range = sht.Range("e7").Value
    
# Edit Header
  
    Set vdoc = ThisDocument
    Set vexcel = New Excel.Application
    Set vwb = vexcel.Workbooks.Open(ThisDocument.Path & "\xxxx.xlsx") 'xxxx is workbook's name
    vexcel.Visible = True
    Set sht = vwb.Worksheets("xxxx") 'xxxx is worksheet's name
    vdoc.Sections(2).Headers(2).Range.Tables(1).Cell(2, 2).Range.Text = sht.Range("e7").Value
    vdoc.Sections(2).Headers(2).Range.Tables(1).Cell(3, 2).Range.Text = sht.Range("c8").Value & "." & sht.Range("c9").Value
    vdoc.Sections(2).Headers(2).Range.Tables(1).Cell(3, 4).Range.Text = sht.Range("c1").Value
    vdoc.Sections(2).Headers(2).Range.Tables(1).Cell(4, 2).Range.Text = sht.Range("e10").Value
    vdoc.Sections(2).Headers(2).Range.Tables(1).Cell(4, 4).Range.Text = sht.Range("e10").Value 
    'section number can be found when click the header,and table number in header is different from the tables in text, it's be renamed , as for header name, you can try to find out it one by one. 
    
# Multiple judgment
    
    Set vdoc = ThisDocument
    Set vexcel = New Excel.Application
    Set vwb = vexcel.Workbooks.Open(ThisDocument.Path & "\xxxx.xlsx")
    vexcel.Visible = True
    Set sht = vwb.Worksheets("xxxx")
    
    If sht.Range("d17").Value = " " Or "-" Then
    vdoc.Tables(6).Cell(2, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(3, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(4, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(5, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(6, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(7, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(8, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(9, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(10, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(11, 3).Range = sht.Range("c17").Value
    End If
    
    If sht.Range("d17").Value <> "" Or "-" & sht.Range("e17").Value = " " Or "-" Then
    vdoc.Tables(6).Cell(2, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(3, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(4, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(5, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(6, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(7, 3).Range = sht.Range("d17").Value
    vdoc.Tables(6).Cell(8, 3).Range = sht.Range("d17").Value
    vdoc.Tables(6).Cell(9, 3).Range = sht.Range("d17").Value
    vdoc.Tables(6).Cell(10, 3).Range = sht.Range("d17").Value
    vdoc.Tables(6).Cell(11, 3).Range = sht.Range("d17").Value
    End If

    If sht.Range("e17").Value <> "" Or "-" Then
    vdoc.Tables(6).Cell(2, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(3, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(4, 3).Range = sht.Range("c17").Value
    vdoc.Tables(6).Cell(5, 3).Range = sht.Range("d17").Value
    vdoc.Tables(6).Cell(6, 3).Range = sht.Range("d17").Value
    vdoc.Tables(6).Cell(7, 3).Range = sht.Range("d17").Value
    vdoc.Tables(6).Cell(8, 3).Range = sht.Range("e17").Value
    vdoc.Tables(6).Cell(9, 3).Range = sht.Range("e17").Value
    vdoc.Tables(6).Cell(10, 3).Range = sht.Range("e17").Value
    vdoc.Tables(6).Cell(11, 3).Range = sht.Range("e17").Value
    End If
# Insert pictures
Insert pictures in batches, format changes with cells, unlock aspect ratio
    
    Sub Macro1()
    '
    ' Macro1 Macro
    '
    ' 快捷键: Ctrl+i
    '
    Application.ScreenUpdating = False
    Dim x, k As Integer
    Dim fs1$
    Dim sht As Worksheet
    Set sht = ThisWorkbook.Worksheets("月度外拓集客表")
    For Each a In sht.Pictures
        a.Delete
    Next
    For x = 1 To 100
        k = x + 3
        fs1 = ThisWorkbook.Path & "\图片\" & "1 (" & x & ")" & ".JPG"
    
        If Dir(fs1) <> "" Then
           sht.Range("c" & k).Select
           ActiveSheet.Pictures.Insert(fs1).Select
         With Selection
             .ShapeRange.LockAspectRatio = msoFalse
             .Placement = xlMoveAndSize
             .Top = sht.Range("c" & k).Top + 5
             .Left = sht.Range("c" & k).Left + 5
             .Height = sht.Range("c" & k).Height - 10
             .Width = sht.Range("c" & k).Width - 10
        End With
       End If
    Next
    Application.ScreenUpdating = True
    End Sub

# Fills the count of the selected ranges in the first cell that is not empty
Use the COUNTA formula

    Private Sub CommandButton1_Click()

' In the certained cell area
' When find the first cell without content
' Fill in the count of expected cells area with COUNTA formula
' And the filled value does not change with the change of the selected cells

On Error Resume Next

Dim i, j
Dim rng As Range

For i = 17 To 22
If Cells(14, i).Value = "" Then
Cells(14, i).Select
ActiveCell.Formula = "=COUNTA(K5:K1048576)" ' fill in the count of expected cells area with COUNTA formula
Cells(14, i).Select
    Selection.Copy
Cells(14, i).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False ' make the filled value does not change with the change of the selected cells
Application.CutCopyMode = False ' disable the cutcopymode of selected cell
Exit For
End If
Next

For j = 17 To 22
If Cells(15, j).Value = "" Then
Cells(15, j).Select
ActiveCell.Formula = "=COUNTA(D5:K1048576)"
Cells(15, j).Select
    Selection.Copy
Cells(15, j).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
Exit For
End If
 
Next

    
End Sub
